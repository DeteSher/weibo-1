查寻在某个时间段内登录，大本等级高于X的玩家，当前的大本等级，历史总付费，还有指定道具获得情况
select g.userId, g.itemId, g.costTotal, g.type, ifnull(payA.payTotal,0) payAll, ifnull(payM.payTotal,0) payMonth,l.level 
from (select userId, itemId, sum(cost) as costTotal, type from goods_cost_record_201812 where time >= 1543622400000 and time < 1543708800000 and  itemId = 200043 group by userId, itemId, type) as g 
left join (select uid, sum(spend) as payTotal from paylog group by uid having payTotal > 0) as payA on g.userId = payA.uid 
left join (select uid, sum(spend) as payTotal from paylog where time >= 1543622400000 and time < 1543708800000 group by uid) as payM on g.userId = payM.uid 
inner join (select uid, level from user_stronghold_level where level > 25) as l on g.userId = l.uid;


select lg.uid, lv.level, ifnull(py.payTotal, 0) payTotal, gd.itemId, ifnull(sum(cost), 0) costTotal from 
(select distinct uid from stat_login_2019_3 where time >= 1554076800000 and time <= 1554854400000 group by uid) lg
inner join
(select uid, level from user_stronghold_level where level > 25) lv on lg.uid = lv.uid
left join
(select uid, sum(spend) payTotal from paylog group by uid) py on lg.uid = py.uid
left join
goods_cost_record_201904 gd on lg.uid = gd.userId 
where gd.type = 0 and gd.itemId in (200043, 200339, 200223) group by lg.uid, gd.itemId, gd.type;

select lg.uid, lv.level, ifnull(py.payTotal, 0) payTotal, gd.itemId, ifnull(gd.costTotal, 0) costTotal from 
(select distinct uid, time from stat_login_2019_3 where time >= 1554076800000 and time <= 1554854400000) lg
inner join
(select uid, level from user_stronghold_level where level > 25) lv on lg.uid = lv.uid
left join
(select uid, sum(spend) payTotal from paylog group by uid) py on lg.uid = py.uid
inner join
(select userId, itemId, sum(cost) as costTotal, type from goods_cost_record_201904 where type = 0 and itemId in (200043, 200339, 200223) group by userId, itemId, type) gd on lg.uid = gd.userId


select gd.userId, lv.level, ifnull(py.payTotal, 0) payTotal, gd.itemId, gd.costTotal from 
(select userId, itemId, sum(cost) as costTotal, type from goods_cost_record_201904 where time >= 1554076800000 and time <= 1554854400000 and type = 0 and itemId in (200043, 200339, 200223) group by userId, itemId, type) gd 
inner join 
(select uid, level from user_stronghold_level where level > 25) lv on gd.userId = lv.uid
left join
(select uid, sum(spend) payTotal from paylog group by uid) py on gd.userId = py.uid

